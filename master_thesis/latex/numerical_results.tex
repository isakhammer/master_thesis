
\newpage
\section{Numerical results}%
\label{sec:numerical_results}


To validate the proposed CutCIP method for the biharmonic problem will we investigate several numerical results both for the Laplace and Hessian formulation. From the theoretical optimal a priori estimates presented in presented in Theorem \ref{thm:apriori_result} will we provide several
examples where it holds: circular domain and a flower domain.
% Hva: Verify the robustness of the CutCIP method for the biharmonic equation and its theoreitical a prioiri estimates
% Hvorfor: Very important to ensure stability, convergence
% Hvordan: Sjekke kondisjonstall , sjekke EOC
% Skriv ned definisjonene av EOC, condisjonstall, og at den er bounded

% \begin{figure}[h!]
%     \centering
%     % \includesvg[width=0.5\textwidth]{results/eoc-test/eoc-hessian-circle-L-2.7-gamma0-20-gamma1-10-gamma2-1/example.svg}

%     \includesvg[width=0.7\textwidth]{example.svg}
%     % \centerline{\includesvg[inkscapelatex=false,width=0.75\columnwidth]{results/eoc-test/eoc-hessian-circle-L-2.7-gamma0-20-gamma1-10-gamma2-1/example.svg}}
%     % \includesvg[width=\textwidth]{p}
%     \caption{Put your caption here.}
%     \label{fig:example}
% \end{figure}

We also demonstrate the effect ghost penalty of stabilization by translating the domain to trigger badly cut cells. Finally, we provide numerical validation of the expected convergence for
the Cahn-Hilliard problem.

We propose the following penalty parameters $\gamma , \gamma _{g1}, \gamma _{g2} = 20,10, 1$.It is worth noting from the results provided in \cite{brenner2012, brenner2012quadratic_kirk,
brenner2012quadratic} is it well known that the main requirement for the CIP formulation is that $\gamma = 5( k -1)\frac{k}{2}$.



\subsection{ Convergence study for the CutCIP method for the Biharmonic Problem  }%
\label{sub:numerical_results_for_cutcip_biharmonic_equation}
For the convergence study will we consider a square background domain $\widetilde{\Omega} $ with side lengths $L$ and a physical domain $\Omega \subset \widetilde{\Omega}$ on the form $\Omega  = \left\{ ( x,y)  \mid \phi ( x,y) \le 0    \right\} $,
where $\phi: \mathbb{R} ^2 \to \mathbb{R}  $ is a given level set function. We will consider two cases; a disk described by $\phi( x,y) = x^{ 2} - y^{2} -1  $ and a flower shaped domain,
\begin{equation}
\label{eq:flower}
\phi ( x,y) =\sqrt{x^{2} + y^{2}} - r_{0} - r_{1}\cos(\atantwo(y,x)) \text{ where }  r_{0} = 0.3L  \text{ and } \ r_{1} = 0.1L .
\end{equation}
For an illustration of the flower domain, see Figure \ref{fig:flower}.

\begin{figure}[h!]
    \centering
\begin{tikzpicture}
  \def\rZero{0.6} % Define r_0
  \def\rOne{0.2} % Define r_1
  \begin{axis}[
    xmin=-1, xmax=1,
    ymin=-1, ymax=1,
    axis lines=center,
    axis equal,
    hide axis,  % This will hide the axis
    % xlabel={$x$},
    % ylabel={$y$},
    % grid=both,
    % minor tick num=1,
    domain=0:2*pi,
    samples=200
  ]

  \addplot[thick, parametric, smooth, fill=blue!30] ({(\rZero + \rOne*cos(5*deg(x)))*sin(deg(x))} , {(\rZero + \rOne*cos(5*deg(x)))*cos(deg(x))});
  \node at (0.1, 0.1) {$\Omega$};
  \node at (0.6, 0.6) {$\phi( x,y ) = 0 $};

  % Background mesh
  \foreach \i in {-1, -0.75, ..., 1} {
      \addplot[ thin, opacity=0.3, forget plot] coordinates {(\i,-1) (\i,1)};
      \addplot[ thin, opacity=0.3, forget plot] coordinates {(-1,\i) (1,\i)};
  }

  \end{axis}
\end{tikzpicture}
\caption{Illustration of the flower domain associated with the level set function \eqref{eq:flower}.}
    \label{fig:flower}
\end{figure}


We want to test spatial convergence for the method by doing a numerous of mesh refinements. Let $ \widetilde{\mathcal{T}_{h}^{k} }$ be the associated regular square mesh of the background domain $\widetilde{\Omega }$ with the mesh size  $h =L /h $ for the refinements
$n \in \left\{ 2^{3+k} \right\}_{k=0}^{6}$, for the circular domain is this illustrated in the Figure \ref{fig:refinement}.

\begin{figure}[h!]
    \centering
\subfloat[]{\label{sub:fig:refine_a}
        \begin{tikzpicture}[scale=0.9]

            % Domain is blue
            \fill[blue!30] (0.1, 0.1) circle (1.5cm);
            \draw[black] (0.1, 0.1) circle (1.5cm);
            \node at (0.2, 0.2) {$\Omega$};

            % Background mesh
            \foreach \i in {-2.5, -2, ..., 2.5} {
                \draw[line width=0.1pt, shift={(-2.5,\i)}, opacity=0.2] (0,0) -- (5,0);
                \draw[line width=0.1pt, shift={(\i,-2.5)},opacity=0.2] (0,0) -- (0,5);
            }

        \end{tikzpicture}

}\hfill
\subfloat[]{\label{sub:fig:refine_b}
        \begin{tikzpicture}[scale=0.9]

            % Domain is blue
            \fill[blue!30] (0.1, 0.1) circle (1.5cm);
            \draw[black] (0.1, 0.1) circle (1.5cm);
            \node at (0.2, 0.2) {$\Omega$};

            % Background mesh
            \foreach \i in {-2.5, -2.25, ..., 2.5} {
                \draw[line width=0.1pt, shift={(-2.5,\i)}, opacity=0.2] (0,0) -- (5,0);
                \draw[line width=0.1pt, shift={(\i,-2.5)},opacity=0.2] (0,0) -- (0,5);
            }

        \end{tikzpicture}


}
\hfill
\subfloat[]{\label{sub:fig:refine_c}
        \begin{tikzpicture}[scale=0.9]

            % Domain is blue
            \fill[blue!30] (0.1, 0.1) circle (1.5cm);
            \draw[black] (0.1, 0.1) circle (1.5cm);
            \node at (0.2, 0.2) {$\Omega$};

            % Background mesh
            \foreach \i in {-2.5, -2.375, ..., 2.5} {
                \draw[line width=0.1pt, shift={(-2.5,\i)}, opacity=0.2] (0,0) -- (5,0);
                \draw[line width=0.1pt, shift={(\i,-2.5)},opacity=0.2] (0,0) -- (0,5);
            }

        \end{tikzpicture}
}
    \caption{Illustration of the domain $\Omega $ defined as a circle with radius $R$. The background mesh is a square domain with side lengths $L$ with three refinements of the mesh size $h$.}
    \label{fig:refinement}
\end{figure}

First we consider the manufactured solution $l,r,m = (2, 1, 1) $ s.t.
\[
u(x,y) = (x^2- y^2 -1) \sin\left(\frac{2\pi m}{l}x\right)\cos\left(\frac{2\pi r}{l}y\right)
\]
on the circular domain.

\begin{table}
\input{results/eoc-test/eoc-hessian-circle-L-2.7-gamma0-20-gamma1-10-gamma2-1/conv-table.tex}

\caption{Convergence rates for the Hessian-based method applied to the circular domain with side length $L=2.7$, using parameters $\gamma=20$, $\gamma_1=10$, and $\gamma_2=0.1$}
\end{table}
\begin{figure}
\input{results/eoc-test/eoc-hessian-circle-L-2.7-gamma0-20-gamma1-10-gamma2-1/conv-plot.tex}
\caption{Convergence rates for the Hessian-based method applied to the circular domain with side length $L=2.7$, using parameters $\gamma=20$, $\gamma_1=10$, and $\gamma_2=0.1$}
\end{figure}

\begin{table}
\input{results/eoc-test/eoc-laplace-circle-L-2.7-gamma0-20-gamma1-10-gamma2-1/conv-table.tex}
\caption{Convergence rates for the Laplacian-based method applied to the circular domain with side length $L=2.7$, using parameters $\gamma=20$, $\gamma_1=10$, and $\gamma_2=0.1$}
\end{table}
\begin{figure}
\input{results/eoc-test/eoc-laplace-circle-L-2.7-gamma0-20-gamma1-10-gamma2-1/conv-plot.tex}
\caption{Convergence rates for the Laplacian-based method applied to the circular domain with side length $L=2.7$, using parameters $\gamma=20$, $\gamma_1=10$, and $\gamma_2=0.1$}
\end{figure}



\begin{table}
\input{results/eoc-test/eoc-laplace-flower-L-2.7-gamma0-20-gamma1-10-gamma2-1/conv-table.tex}
\caption{Convergence rates for the Laplacian-based method applied to the Flower domain with side length $L=2.7$, using parameters $\gamma=20$, $\gamma_1=10$, and $\gamma_2=1$}
\end{table}
\begin{figure}
\input{results/eoc-test/eoc-laplace-flower-L-2.7-gamma0-20-gamma1-10-gamma2-1/conv-plot.tex}
\caption{Convergence rates for the Laplacian-based method applied to the Flower domain with side length $L=2.7$, using parameters $\gamma=20$, $\gamma_1=10$, and $\gamma_2=1$}
\end{figure}



% Here we consider the manufactured solution $l,r,m = (2, 1, 1) $ s.t.
% \[
% u_{\text{ex}}(x,y) = \sin\left(\frac{2\pi m}{l}x_1\right)\cos\left(\frac{2\pi r}{l}y\right)
% \]
% on the flower domain for the Laplace equation. Here is the flower domain described as
%  Recall the polar coordinates $r = \sqrt{x^2 + y^2}$ and $\theta = atan( x,y) $. Then we define the flower level set function $\phi$ to be on the form
%  \begin{equation}
%  \label{eq:flower}
% \phi(x, y) = r_0 + r_1  cos(5 \theta) - r = 0
%  \end{equation}
Here we define the parameters $r_0= 0.3L$ and $ r_1=0.1L$.

\subsubsection{Translation test}%
\label{ssub:translation_test}


Here we have the translation test $\delta $ from $0$ to $2 \sqrt{2}h $.


\begin{figure}
    \centering
    \begin{tikzpicture}[scale=0.9]

        % Domain is blue
        % \fill[blue!30] (0.1, 0.1) circle (1.5cm);

        \coordinate (p0) at (0.1, 0.1);  % the origin of the circle

        \draw[black,line width=0.8pt, opacity=1.0 ] (0.1, 0.1) circle (1.1cm);
        \draw[black,line width=0.8pt, opacity=0.7 ] (0.4535, 0.4535) circle (1.1cm);
        \draw[black,line width=0.8pt, opacity=0.3 ] (0.807, 0.807) circle (1.1cm);
        \draw[black,line width=0.8pt, opacity=0.2 ] (1.16, 1.16) circle (1.1cm);

        % Drawing points
        \fill[black] (p0) circle (2pt);
        \pgfmathsetmacro{\pOneX}{0.1 + 1.5*sqrt(2)*0.5}
        \pgfmathsetmacro{\pOneY}{0.1 + 1.5*sqrt(2)*0.5}
        \coordinate (p1) at (\pOneX, \pOneY);

        \draw[->, thick] (p0) -- (p1) node[midway,below] {$\delta$};
        % Background mesh
        \foreach \i in {-2.5, -2, ..., 2.5} {
            \draw[line width=0.1pt, shift={(-2.5,\i)}, opacity=0.2] (0,0) -- (5,0);
            \draw[line width=0.1pt, shift={(\i,-2.5)},opacity=0.2] (0,0) -- (0,5);
        }

    \end{tikzpicture}
    \caption{Illustration of the translation test with translation $\delta$ from  $(0,2 \sqrt{2}h)  $ }
\end{figure}


\begin{figure}[htp]
\centering

\subfloat[]{%
\input{"results/translation-test/hessian-n-16-it-500-L-2.7/translation-cond.tex"}
}

\subfloat[]{%
\input{"results/translation-test/hessian-n-16-it-500-L-2.7/translation-error.tex"}
}


\caption{ Translation results for Hessian $n=16$ for $500$ iterations, $\delta =(0, 2 \sqrt{2}h) $ for $L=2.7$ with a circle $R=1$       }

\end{figure}

\begin{figure}[htp]
\centering

\subfloat[]{%
\input{"results/translation-test/laplace-n-16-it-500-L-2.7/translation-cond.tex"}
}

\subfloat[]{%
\input{"results/translation-test/laplace-n-16-it-500-L-2.7/translation-error.tex"}
}


\caption{ Translation results for Laplace $n=16$ for $500$ iterations, $\delta =(0, 2 \sqrt{2}h) $ for $L=2.7$ with a circle $R=1$       }

\end{figure}
