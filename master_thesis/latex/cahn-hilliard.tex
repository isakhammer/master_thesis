
\newpage
\section{Application to the Cahn Hilliard equation }%
\label{sec:cahn_hilliard_equation}

In this section, we will demonstrate that the proposed cut finite element method can be used to solve the Cahn-Hilliard problem. Firstly, we will recall the strong form and illustrate how it can be recast into a weak form following the approach in
\cite{feng2007fully}. Subsequently, we will derive a simplistic numerical time iteration scheme to demonstrate that the solution to the problem can indeed be found. Again, all numerical experiments are conducted using the open-source finite element method (FEM) framework, Gridap, as documented in \cite{verdugo22}.


\subsection{Revisiting the strong formulation}%
\label{sub:revisiting_the_strong_formulation}

We will do a short revisit of the strong Cahn-Hilliard equation. Recall that,
\begin{equation}
\label{eq:strong_ch}
    \begin{split}
\partial _{t} u + \Delta  \left(  \varepsilon  \Delta u - \frac{1}{\varepsilon }f( u) \right)   &=0  \quad \text{ in } \Omega  \\
\partial _{n} u &= 0 \quad \text{ on } \Gamma  \\
\partial _{n}    \Delta u       &= 0 \quad \text{ on } \Gamma  \\
    \end{split}
\end{equation}
Where we defined $f( u) = u( u^{2} -1)  = F' ( u)  $ where $F( u) = ( 1 / 4 ) ( u^2 -1 ) ^{2} $. With the corresponding energy.
\begin{equation}
E( u)  = \int_{\Omega }^{} \frac{\varepsilon }{2} \abs{ \nabla u } ^2 + \frac{1}{\varepsilon } F( u) dx
\end{equation}

We also recall that the energy functional monotonically decreasing and that the global mass concentration is conserved, i.e.
\begin{equation}
\label{eq:mass_cons_energy_decrease}
\frac{d}{dt} E( u)  <  0 \text{ and }\frac{d}{dt} \int_{\Omega }^{}  u dx = 0.
\end{equation}

Now assume that $u \in L^2( [0,T], H^{4}( \Omega ) ) $ and $v_{h} \in  V_{h}$ of order $k$. It is clear that the initial weak formulation is,
\begin{equation}
    ( \partial_{t} u,v_{h} )_{\Omega }  + ( \Delta ^2u, v_{h})_{\Omega } - ( f( u), v_{h} )_{\Omega } = 0.
\end{equation}

As we can see did the biharmonic equation appear and, thus, we can apply the cut finite element bilinear form proposed in Equation \eqref{eq:discrete_CutCIP_prob}. By also utilizing the  can we discretize the problem.
\begin{equation}
    \begin{split}
        & \text{Find  }u_{h} \in L^{2}( [0,T],V_{h})  \text{ such that } \forall v_{h} \in V_{h} \\
        & ( \partial_{t} u_{h},v_{h} )_{\Omega }   + \frac{1}{\varepsilon }A_{h}( u_{h},v_{h})   + \varepsilon c_{h}( u_{h},v_{h})  = 0.
    \end{split}
\end{equation}
Here we have followed the nonlinear weak formulation \cite[Equation
4.2]{feng2007fully} such that
\begin{equation}
    c_{h}( u_{h}, v_{h})  = ( f( u_{h}) ,\Delta v_{h})_{\Omega } +  ( f( u_{h}) , \partial _{n}v)_{\mathcal{F}_{h} }
\end{equation}





\subsection{Development of an Implicit-Explicit Scheme}
\label{sub:implicit_explicit_scheme}

The primary aim is to formulate an uncomplicated time iteration scheme. Define the index $m$ to range over the set ${0, 1, \ldots, M}$, which corresponds to uniformly distributed time points $t_{m}$ that satisfy the boundary conditions $t_{0} = 0$
and $t_{M} = T$. Here, each time step is an element of the function space, i.e. $u^{m}_{h} \in V_{h}$  with the initial condition defined as $u^{0} = u( t_{0},x )$.
For the Implicit explicit scheme (IMEX) sceheme we have the following discretization
\[
( \overline{\partial } _{t} u^{m}_{h}, v_{h}   )_{\Omega } + \varepsilon a^{m}_{h}( u_{h}^{m} , v) + \frac{1}{\varepsilon } c_{h} (  u_{h}^{m-1}, v_{h})  = l_{h}( v) , \quad \forall v_{h}, u^{m}_{h} \in V^{}_{h}.
\]

Here we have define the forward difference operator with time step $\tau $
\[
\overline{\partial } _{t} u_{h}^{m} = \frac{u_{h}^{m} - u_{h}^{m-1}}{ \tau }
\]
, then we have the following scheme.
\[
( u_{h}^{m},v )_{\Omega }  + \tau \varepsilon a_{h}( u_{h}^{m} , v)   = \tau  l_{h}( v) +   ( u_{h}^{m-1},v )_{\Omega } - \frac{\tau}{\varepsilon } c_{h} (  u_{h}^{m-1}, v) .
\]

 % Recall that $V_{h}$ is spanned by the orthonormal polynomial basis $ \left\{ \phi _{j} \right\}_{i=1}^{ N}  $ with $N$ degrees of freedom  s.t.  $v = \sum_{i}^{N} V_{i} \phi_{i}   $ and $u_{h} = \sum_{i}^{N} U_{i} \phi_{i}   $.
 %    Let  $U^{m} = \left[ U_{1}, \ldots, U^{N} \right]^{T} $ and $V= \left[ V_{1}, \ldots, V_{M} \right]^{T} $. Writing the matrices $[ A ]_{i,j} =  a( \phi _{i}, \phi _{j})  $ and $\left[ F \right] _{j} = l_{h}( \phi _{j})  $ and $ \left[ C \right]_{ij}
 %    = c_{h}( U^{m-1} \phi _{j}, \phi _{j}) $  .
 %    Subsequently, we can express the system in an equivalent explicit system.
 %    \[
 %        \begin{split}
 %            U^{m}  + \tau \varepsilon A U^{m} & = ( I  + \tau \varepsilon A ) U^{m}   \\
 %            b(U^{m-1}, V) &:=   \tau  F +   ( u_{h}^{m-1},v )_{\Omega } - \frac{\tau}{\varepsilon } c_{h} (  u_{h}^{m-1}, v)
 %        \end{split}
 %    \]
 %    s.t. $  ( I  + \tau \varepsilon A ) U^{m} = b(U^{m-1}, V )  $


\subsection{Demonstration on the physical Cahn-Hilliard problem}%
\label{sub:demonstration_on_the_physical_cahn_hilliard}

On the physical CH \eqref{eq:strongch} presented we have no analytical solution to check the solution. However, a way to check that the system does behave like expected based on the physical properties \eqref{eq:mass_cons_energy_decrease}. In other
words, we can check that our discrete solution satisfies \[
    \begin{split}
 E( u_{h}( \cdot , t_{2}) ) & \le  E( u_{h}( \cdot , t_{1}) )   \text{ for } 0 < t_{1} < t_{2},  \\
\int_{\Omega }^{} u_{h} ( x,t)  dx & = \int_{\Omega }^{} u_{0}(x)  dx,
    \end{split}
\]
where $u_{0}( x) = u_{h}( x,t) $. Let us define
\[
 e_{u} = \frac{ \int_{\Omega }^{}  u_h(x,t)- u(0,x) dx}{ \int_{\Omega }^{}  u(x,0) dx}
\]


\begin{figure}[H]
    \centering
    \subfloat[$t=0\tau$]{\label{sub:fig:ill_c0}
        \includegraphics[width=0.3\textwidth]{results/illustration/c0.png}
    }\hfill
    \subfloat[$t=2\tau$]{\label{sub:fig:ill_c2}
        \includegraphics[width=0.3\textwidth]{results/illustration/c2.png}
    }\hfill
    \subfloat[$t=10\tau$]{\label{sub:fig:ill_c10}
        \includegraphics[width=0.3\textwidth]{results/illustration/c10.png}
    }
    \vspace{10pt}
    \subfloat[t=50$\tau$]{\label{sub:fig:ill_c50}
        \includegraphics[width=0.3\textwidth]{results/illustration/c50.png}
    }\hfill
    \subfloat[$t=200\tau$]{\label{sub:fig:ill_c200}
        \includegraphics[width=0.3\textwidth]{results/illustration/c200.png}
    }\hfill
    \subfloat[$t=1000\tau$]{\label{sub:fig:ill_c1000}
        \includegraphics[width=0.3\textwidth]{results/illustration/c1000.png}
    } \\
    \vspace{10pt}
    \centering
    \subfloat[$t=0\tau$]{\label{sub:fig:ill_f0}
        \includegraphics[width=0.3\textwidth]{results/illustration/f0.png}
    }\hfill
    \subfloat[$t=2\tau$]{\label{sub:fig:ill_f2}
        \includegraphics[width=0.3\textwidth]{results/illustration/f2.png}
    }\hfill
    \subfloat[$t=10\tau$]{\label{sub:fig:ill_f10}
        \includegraphics[width=0.3\textwidth]{results/illustration/f10.png}
    }
    \vspace{10pt}
    \subfloat[$t=50\tau$]{\label{sub:fig:ill_f50}
        \includegraphics[width=0.3\textwidth]{results/illustration/f50.png}
    }\hfill
    \subfloat[$t=200\tau$]{\label{sub:fig:ill_f200}
        \includegraphics[width=0.3\textwidth]{results/illustration/f200.png}
    }\hfill
    \subfloat[$t=1000\tau$]{\label{sub:fig:ill_f1000}
        \includegraphics[width=0.3\textwidth]{results/illustration/f1000.png}
    }
    \caption{Illustration of simulations of the Cahn-Hilliard equation on the circle and a flower domain for $t\in \left[ 0, 1000\tau  \right] $.}
    \label{sub:fig:ill_circle_flower}
\end{figure}



We ran the simulation on the for the flower domain \eqref{eq:flower} and the circular domain \eqref{eq:circle}, illustrated in Figure \ref{sub:fig:ill_circle_flower} . The corresponding plots of the mass conservation and energy decrease are presented
in the Figure \ref{fig:physical_CH_plot}, and confirm the expected physical properties of the Cahn-Hilliard equation. The relative error $e_{u}$ shows small deviations of the numerical solution in the order of $10^{ -10 }$ demonstrating that the mass is conserved. We also observe that the energy functional
$E(u_h)$ decreases over time, signifying the system's tendency to seek a state of minimal energy.


\begin{figure}[h!]
\input{"results/physical_CH_plot.tex"}
\caption{Evolution of the error measure, $e_{L^{1}(\Omega)}$ and the energy functional $E(u_h)$ over time for two different domains: a circular domain and a flower-shaped domain.  }
\label{fig:physical_CH_plot}
\end{figure}


\subsection{Note on the manufactured solution}%
\label{sub:the_problem}

While the report is not consisting of a full worthy experiments of convergence analysis, we still present a framework for manufactured solutions.

Recall the strong form Cahn-Hilliard equation. Let $ u( x,0) =  u_{0}$ then is the dynamics on the form,
\begin{subequations}
    \label{eq:ch_gen}
    \begin{align}
    \label{eq:ch_gen:a}
        \partial _{t} u + \Delta  \left(  \varepsilon  \Delta u - \frac{1}{\varepsilon }f( u) \right)   &= g_{0}( x)   \quad \text{ in } \Omega  \\
        \partial _{n} u &= g_{1}( x)  \quad \text{ on } \Gamma  \\
        \partial _{n}    \Delta u   &= g_{2}(x)  \quad \text{ on } \Gamma
    \end{align}
\end{subequations}
where we defined $f( u) = F'( u) =u( u^2 -1)  $ for $F( u) = \frac{1}{4}( u^{2} - 1)^{2} $ and the domain $\Omega \subset \mathbb{R} ^{d} $  for $d = 2,3$. In contrast to the standard version presented in the introduction \eqref{eq:strongch}, is this version
generalized to also holds for for functions $g_{0},g_{1},g_{2}: \Omega \to\mathbb{R}   $. While the standard version may be physical correct, this version creates flexibility so we can easily construct manufactured solution on complex domains.

    Designing a manufactured solution using $g_{0}( \cdot ) $ may be temping with the formulation \eqref{eq:ch_gen:a}. However, observe that expanding the Laplacian we get,
    \begin{equation}
    \begin{split}
        \Delta  \left(  \varepsilon  \Delta u - \frac{1}{\varepsilon }f( u) \right) & = \varepsilon \Delta^2 u - \frac{1}{\varepsilon } \Delta f( u) \\
                                                                                    &= \varepsilon \Delta ^2 u  - \frac{3}{\varepsilon }( 2u \| \nabla u \|_{ 2 }^{ 2 } + u^{2}  \Delta u )   \\
    \end{split}
    \end{equation}
Here we applied the chain rule twice and inserted the derivatives.
\begin{equation}
    \label{eq:nonlinear_laplace}
    \begin{split}
\Delta f( u)  &= \nabla \cdot \nabla f( u)  = \nabla \cdot  \left[ f' ( u) \partial _{x_{1}}u, \ldots, f' ( u) \partial _{x_{d}}u \right] ^{T} \\
& =  f'' ( u)( ( \partial _{x_{1}}u )^{2} + \ldots +( \partial _{x_{d}}u )^{2} ) +  f' ( u)( \partial _{x_{1} x_{1}}u + \ldots +   \partial _{x_{d} x_{d}}u ) \\
&=  f'' ( u) \| \nabla u \|_{ 2 }^{ 2 } + f' ( u)  \Delta u  = 6u \| \nabla u \|_{ 2 }^{ 2 } + 3u^{2}  \Delta u
    \end{split}
\end{equation}

Our goal is to write the Cahn Hilliard equation on weak form.
Assume that $\Omega  \subset \mathbb{R} ^{d}$ with a $\Gamma $ in $C^2$.
 Let $u \in  H^{4}( \Omega ) $ and $v \in V_{h} $.
Now, expanding the first Laplace operator from a weak point of view is it clear that
\[
 ( \Delta ( \varepsilon  \Delta u - \frac{1}{\varepsilon } f( u) ) ,v )_{\Omega } = \varepsilon ( \Delta^{2} u ,v )_{\Omega } - \frac{1}{\varepsilon } ( \Delta f( u)  ,v )_{\Omega }.
\]
Hence, this makes it natural to associate the biharmonic $( \Delta ^2 u,v)_{\Omega } $ with bilinear forms $A_{h}( \cdot ,\cdot ) $ , however, in this section will we only consider the Laplace
variant $a^{L}( \cdot ,\cdot ) $.

We will now find seek to find a bilinear form of the nonlinear term,
\begin{lemma}[Semi-linear form]
    Let $u \in H^4( \Omega ) $ be solution to \eqref{eq:ch_gen} and $v_{h} \in V_{h}$ the test function.
Then can we rewrite the nonlinear term into the corresponding semi-linear form $c_{h}( \cdot ,\cdot )  $ for the nonlinear term $( -\Delta f( u) , v_{h})_{\Omega }$ into two consistent formulations.
\begin{align}
    \label{eq:ch:1}
      c^{1}_{h} ( u,v_{h})  & = ( f' ( u) \nabla u, v_{h} )_{\Omega }  - ( f'( u)  g_{1}   ,  v_{h})_{\Gamma } \\
    \label{eq:ch:2}
        c^{2}_{h} ( u,v_{h})  & = -( f( u), \Delta v_{h} )_{\Omega }+  ( f( u) , \jump{ \partial _{n}v_{h} }  )_{\mathcal{F} _{h}^{int}} + ( f(u), \partial _{n} v_{h})_{\Gamma  }  - ( f'( u)  g_{1}   ,  v_{h})_{\Gamma }
\end{align}
% \begin{remark}
%     Be aware that the both formulations are consistent and if we replace $u \in H^{4}( \Omega ) $ with  $u_{h} \in  V_{h}$ we have two different discrete formulations.
% \end{remark}

\end{lemma}
% \todo[inline]{ I criticize \cite[ Remark 4.1d]{feng2007fully} which says that says that finding this weak form is not possible for conforming methods (I guess $C^{0}$ is a conforming method??). }

\begin{proof}

         \textbf{Derivation of \eqref{eq:ch:1}.  }  We want to construct the first formulation. Let $T$ be an element in $\mathcal{T}_{h}$. From Greens theorem is it easy to see that
            \begin{equation}
            \label{eq:1_gr}
-(\Delta f( u) , v_{h})_{T } = (\nabla f( u), \nabla v_{h}  )_{T } - ( \partial _{n}  f( u), v_{h} )_{\partial T }
            \end{equation}
            First by utilizing that $\nabla f( u) = f' ( u) \nabla u $ and $\partial _{n}f( u)  = f' ( u)  \partial _{n}u$  and doing a summation over the triangles  is it clear that \[
            ( -\Delta f( u),v_{h} )_{\Omega  } =(f' ( u) \nabla u, \nabla v_{h}  )_{\Omega  } - (   f' ( u)\partial _{n}u, v_{h} )_{\partial \mathcal{T}_{h}  }
            \]
            Iterating over the facets is it clear that \[
                \begin{split}
            (   f' ( u)\partial _{n}u, v_{h} )_{\partial \mathcal{T}_{h}  } & = \sum_{F \in \mathcal{F}_{h}  }^{} \int_{F}^{}   \jump{ f' ( u)\partial _{n}u, v_{h} } \\
                                                                        & =  ( \jump{ f' ( u) \partial _{n}u },  \mean{v_{h}}    )_{\mathcal{F}^{int}_{h} } + ( \mean{ f' ( u) \partial _{n}u }, \jump{ v_{h} }    )_{\mathcal{F}^{int}_{h} } +  ( f' ( u)
                                                                        \partial _{n}u, v_{h}) _{\Gamma } \\
                                                                        & =  ( f' ( u) \partial _{n}u, v_{h}) _{\Gamma }
                \end{split}
            \]
            The jump terms vanishes by the regularity of $u$ and $v_{h}$. Hence, by inserting $g_{1}$ we have shown that the first formulation holds.

         \textbf{Derivation of \eqref{eq:ch:2}.  }  Applying a extra iteration of Greens theorem on \eqref{eq:1_gr} we get the following terms.
\[
    \begin{split}
-(\Delta f( u) , v_{h})_{T }  = -( f( u), \Delta v_{h} )_{T} + (f( u), \partial _{n} v_{h}  )_{\partial T} - (   f'( u)\partial _{n}u, v_{h} )_{\partial T } .
    \end{split}
\]
Now, by doing a summation of all triangles it is clear that this holds.
\begin{equation}
\label{eq:f_g2}
-(\Delta f( u) , v_{h})_{\Omega  }  = -( f( u), \Delta v_{h} )_{\Omega } + (f( u), \partial _{n} v_{h}  )_{\partial \mathcal{T}_{h} } - (   f'( u)\partial _{n}u, v_{h} )_{\partial \mathcal{T}_{h}  }
\end{equation}
It comes evident from the first step of the proof that $ (   f'( u)\partial _{n}u, v_{h} )_{\partial \mathcal{T}_{h}  } = (   f'( u)\partial _{n}u, v_{h} )_{\Gamma }$, hence, we only need to compute the term $(f( u), \partial _{n} v_{h}  )_{\partial
\mathcal{T}_{h} }$ on the facets. \[
    \begin{split}
(f( u), \partial _{n} v_{h}  )_{\partial
\mathcal{T}_{h} } & = \sum_{F\in \mathcal{F} _{h}}^{} \int_{F}^{}\jump{ f( u), \partial _{n} v_{h}  } \\
& =  (\jump{ f( u)  }  , \mean{ \partial _{n} v_{h} }    )_{ \mathcal{F}_{h}^{int} } +(\mean{ f( u)  }  , \jump{ \partial _{n} v_{h} }    )_{ \mathcal{F}_{h}^{int} } + (f( u), \partial _{n} v_{h}  )_{\Gamma } \\
&=  (\mean{ f( u)  }  , \jump{ \partial _{n} v_{h} }    )_{ \mathcal{F}_{h}^{int} } + (f( u), \partial _{n} v_{h}  )_{\Gamma }
    \end{split}
\]
Again one of the jump terms vanishes because of the regularity of $u$.
Inserting the result into \eqref{eq:f_g2} have we shown that the second formulation also holds.

The consistency follows in a weak sense for $u \in H^{4}( \Omega ) $.
\end{proof}

Hence, we have a scheme for nonlinear spatial discretization. Let $u_{h} \in \left[ 0,T \right] \times V_{h}  $ and $v_{h} \in V_{h}$. We define the following CIP discretization
\begin{equation}
    \label{eq:cip_ch}
    \begin{split}
        a_{h} \left( u_{h}, v_{h} \right)   =& ( \Delta  u_{h}, \Delta v_{h} ) _{ \Omega } \\
                                     & + \left( \mean{  \Delta  u_{h} }, \jump{ \partial _{n }v_{h}} \right)_{\mathcal{F}_{h}  }  + \left( \mean{ \Delta  v_{h} }, \jump{ \partial _{n}u_{h} }      \right)_{\mathcal{F}_{h}  }  + \frac{\gamma }{h}
                                     \left( \jump{ \partial _{n} u_{h}}, \jump{ \partial _{n} v_{h}   }   \right)_{\mathcal{F}_{h} } \\
                                     & + \left(   \Delta  u_{h} ,  \partial _{n }v_{h} \right)_{\Gamma   }  + \left(  \Delta  v_{h} ,  \partial _{n}u_{h}       \right)_{\Gamma  }  + \frac{\gamma }{h}  \left(  \partial _{n} u_{h},  \partial _{n} v_{h}      \right)_{ \Gamma } \\
    c^{}_{h} ( u_{h},v_{h})  & = -( f( u_{h}), \Delta v_{h} )_{\mathcal{T} _{h}}+  ( f( u_{h}) , \jump{ \partial _{n}v_{h} }  )_{\mathcal{F} _{h}^{int}} + ( f(u_{h}), \partial _{n} v_{h})_{\Gamma  }  + ( f'( u_{h})  g_{1}   ,  v_{h})_{\Gamma } \\
    l_{h}( v_{h}) & =  \left( g_{0}, v_{h} \right) _{\Omega } -  \varepsilon ( g_{2},  v_{h} )_{\Gamma }  -  \varepsilon ( g_{1}, \Delta  v_{h}  )_{\Gamma }  + \varepsilon \frac{\gamma }{h} ( g_{1}, \partial _{n} v_{h}  )_{\Gamma }
    \end{split}
\end{equation}
such that that the following relationship holds.
\[
    ( \partial _{t}u_{h}, v_{h})_\Omega + \varepsilon  a_{h}( u_{h},v_{h}) + \frac{1}{\varepsilon }c_{h}( u_{h},v_{h})   =  l_{h}(v_{h}) \quad  \forall u_{h}, v_{h} \in V_{h}
\]


