
\newpage
\section{Cahn Hilliard equation }%
\label{sec:cahn_hilliard_equation}


\begin{itemize}
    \item Explain the full discretization scheme including Follow \cite{feng2007fully}
    \item CutFEMCIP for spatial discretization
    \item implicit Euler for temporal discretization
    \item linearization of nonlinearity (IMEX)
\end{itemize}


\subsection{The linear Cahn-Hilliard}%

We will consider linear Cahn Hilliard problem. Let $ u( x,0) =  u_{0}$ then is the formulations

\begin{equation}
\label{eq:ch_exact}
    \begin{split}
        \partial _{t} u  + \varepsilon \Delta^2   u -   & =  h(x)  \quad \text{in} \Omega \\
        \partial _{n} u & =  g_{1}(x)  \quad \text{ on } \Gamma \\
         \partial _{n} \Delta u & = g_{2}(x)  \quad \text{ on } \Gamma  \\
    \end{split}
\end{equation}



We can see that the simplest weak formulation for $u,v \in H^{4}( \Omega ) $ is on the form,
\[
( \partial _{t}u, v )_{\Omega }  - \varepsilon ( \Delta^2 u, v)_{\Omega } = ( h,v)_{\Omega }   \\
\]
We can easily observe that the biharmonic equation is a term of this equation. Combining the theory from \ref{sec:cutcip_biharmonic_problem} and can we see that the Laplace formulation



\subsection{The general Cahn-Hilliard}%
\label{sub:the_problem}

Recall the strong form Cahn-Hilliard equation. Let $ u( x,0) =  u_{0}$ then is the dynamics on the form,

\begin{equation}
\label{eq:ch_gen}
    \begin{split}
\partial _{t} u + \Delta  \left(  \varepsilon  \Delta u - \frac{1}{\varepsilon }f( u) \right)   &= h( x)   \quad \text{ in } \Omega  \\
\partial _{n} u &= g_{1}( x)  \quad \text{ on } \Gamma  \\
\partial _{n}    \Delta u   &= g_{2}(x)  \quad \text{ on } \Gamma  \\
    \end{split}
\end{equation}
where we used the notation $f( u) = F'( u) =u( u^2 -1)  $ for $F( u) = \frac{1}{4}( u^{2} - 1)^{2} $. $\Omega \subset \mathbb{R} ^{d} $  for $d = 2,3$. In contrast to the standard version presented in the introduction \eqref{eq:strongch}, is this version
generalized to also holds for for functions $h,g_{1},g_{2}: \Omega \to\mathbb{R}   $. While the standard version may be physical correct, this version creates flexibility so we can easily construct manufactured solution on complex domains.



\subsection{ CIP method for the Cahn Hilliard Equation on a Polygonal mesh}%
\label{sub:writing_the_cahn_hilliard_equation_of_weak_form}

Our goal is to write the Cahn Hilliard equation on weak form.
Assume that $\Omega  \subset \mathbb{R} ^{d}$ is a polygon.
 Let $u \in  H^{4}( \Omega ) $ and $v \in V_{h} $ where
\[
V_{h} = \left\{ v \in C^{0}( \Omega )   \mid v\in \mathcal{P} ^{k} ( T) \quad \forall T \in \mathcal{T} _{h} \right\}.
\]
Expanding the first Laplace operator can we observe that,
\[
 ( \Delta ( \varepsilon  \Delta u - \frac{1}{\varepsilon } f( u) ) ,v )_{\Omega } = \varepsilon ( \Delta^{2} u ,v )_{\Omega } - \frac{1}{\varepsilon } ( \Delta f( u)  ,v )_{\Omega }.
\]
Hence, this makes it natural to associate the biharmonic $( \Delta ^2 u,v)_{\Gamma } $ with bilinear forms $a_h^{H} $ in  and $a^{H}_{h} $ from Section \ref{sec:CIP_biharmonic_problem}, however, in this section will we only consider the Laplace
variant $a^{L}$.
We will now find seek to find a bilinear form of the nonlinear term,

\begin{lemma}[Semi-linear form]
    Let $u \in H^2( \Omega ) $ and $v \in V_{h}$ the test function.
Then can we rewrite the nonlinear term into the semi-linear form, $( -\Delta f( u) , v)_{\Omega } = c_{h}(u,v )   $, where
\[
    c^{}_{h} ( u,v)  = -( f( u), \Delta v )_{\mathcal{T} _{h}}+  ( f( u) , \jump{ \partial _{n}v }  )_{\mathcal{F} _{h}^{int}} + ( f(u), \partial _{n} v)_{\mathcal{F}^{ext}_{h} }  + ( f'( u)  \partial _{n}u   ,  v)_{\mathcal{F} _{h}^{ext}}
\]

\end{lemma}
\todo[inline]{ I am really sure the minus sign in front of $ \sum_{e \in \mathcal{E}^{I} }^{} \left<f' ( \mean{ u }  ) \mean{ \partial _{n} u }   , \jump{ v }    \right>_{e} $  in \cite[ Equation 4.2]{feng2007fully}  must be wrong. I also criticize
\cite[ Remark 4.1d]{feng2007fully} which says that says that finding this weak form is not possible for conforming methods (I guess $C^{0}$ is a conforming method??). }

\begin{proof}
  We can easily see by doing Greens theorem twice that \[
    \begin{split}
-(\Delta f( u) , v)_{T } &= -(\nabla f( u), \nabla v  )_{T } + ( \partial _{n}  f( u), v )_{\partial T }.\\
                    & = -( f( u), \Delta v )_{T} + (f( u), \partial _{n} v  )_{\partial T} + (   f'( u)\partial _{n}u, v )_{\partial T } .
    \end{split}
\]
We have utilized the relationship $\partial _{n} f(u) = f' ( u) \partial _{n}u$.
 Summation of the triangles we get the following problem,
\[
\sum_{T \in  \mathcal{T} _{h} }^{} -(\Delta f( u) , v)_{T } = \sum_{T \in \mathcal{T} _{h}}^{}  -( f( u), \Delta v )_{T} + (f( u), \partial _{n} v  )_{\partial T} + (   f'( u)\partial _{n}u, v )_{\partial T }.
\]
It is apparent that rewriting the system to summation of the facets we conclude that, \[
    \begin{split}
\sum_{T \in \mathcal{T}_{h} }^{} ( f( u) , \partial _{n}v)_{\partial T} & =  \sum_{F \in \mathcal{F}_{h} }^{} \int_{F}^{}  \jump{    f( u) \partial _{n}v}   \\
& = ( f(u), \partial _{n} v)_{\mathcal{F}^{ext}_{h} }  +  ( \jump{f( u)} , \mean{ \partial _{n}v }  )_{\mathcal{F} _{h}^{int}} + ( \mean{f( u)}
, \jump{ \partial _{n}v }  )_{\mathcal{F}^{int}_{h} } \\
 & = ( f(u), \partial _{n} v)_{\mathcal{F}^{ext}_{h} } +   ( \mean{f( u)} , \jump{ \partial _{n}v }  )_{\mathcal{F}^{int}_{h} } \\
 & = ( f(u), \partial _{n} v)_{\mathcal{F}^{ext}_{h} } +  ( f( u) , \jump{ \partial _{n}v }  )_{\mathcal{F} _{h}^{int}}
    \end{split}
    .
\]
Here we used that $ \jump{ f( u)  } = 0  $ and $\mean{ f( u)  } = f( u)  $  since $u \in H^2( \Omega ) $. Also remark that $\jump{ \partial _{n}v } \neq 0   $ from $v \in V_{h}$. We can do similar procedure for the other term.
\[
    \begin{split}
        \sum_{T \in \mathcal{T} _{h}}^{} (   f'( u)\partial _{n}u, v )_{\partial T } &=  \sum_{F \in \mathcal{F}_{h} }^{} \int_{F}^{}  \jump{( f'( u)\partial _{n}u  ) v } \\
& = (\mean{ f'( u)\partial _{n}u }  , \jump{ v }   )_{\mathcal{F}^{ext}_{h} } + (\mean{ f'( u)\partial _{n}u }  , \jump{ v }   )_{\mathcal{F}^{int}_{h} } +  (\jump{ f'( u)\partial _{n}u }  , \mean{ v }   )_{\mathcal{F}^{int}_{h} } \\
                                                                             & =  ( f'( u)  \partial _{n}u   ,  v
                                                                             )_{\mathcal{F} _{h}^{ext}}
    \end{split}
\]
Again, here a similar identities $\jump{  f' ( u) \partial _{n} u} = 0  $ since $u \in H^2( \Omega ) $. Ultimately, from the continuity of $v$ is the jump term eliminated, $ \jump{v} = 0 $. Hence, we end up with the following formulation.
\[
    \begin{split}
-(\Delta f( u) , v)_{ \mathcal{T}_{h}  } &= -(\nabla f( u), \nabla v  )_{ \mathcal{T}_{h}  } + ( \partial _{n}  f( u), v )_{\partial \mathcal{T}_{h}  }.\\
                    & = -( f( u), \Delta v )_{\mathcal{T} _{h}} + (f( u), \partial _{n} v  )_{\partial \mathcal{T} _{h}} + (   f'( u)\partial _{n}u, v )_{\partial \mathcal{T} _{h} } \\
&= -( f( u), \Delta v )_{\mathcal{T} _{h}} +  ( f( u) , \jump{ \partial _{n}v }  )_{\mathcal{F} _{h}^{int}} + ( f(u), \partial _{n} v)_{\mathcal{F}^{ext}_{h} }  + ( f'( u)  \partial _{n}u   ,  v)_{\mathcal{F} _{h}^{ext}}
    \end{split}
.
\]
\end{proof}

As a note on imposing the nonlinear boundary condition. Observe we can rewrite the boundary condition in the following way, $$
\partial _{n}\left( \varepsilon \Delta u + \frac{1}{\varepsilon } f( u)  \right) = \varepsilon \partial _{n}\Delta u + \frac{1}{\varepsilon }f' ( u) \partial _{n} u = \varepsilon \partial _{n}\Delta u +
\frac{1}{\varepsilon } f' ( u) g_{1} =  g_{2}
$$ for $u$ evaluated on $  \Gamma  $. Suppose we want
to impose $g_{2}$ condition using the classic standard method in Subsection \ref{sub:construction_of_laplacian_cip}. We see that from the first step that  \[
    \begin{split}
\varepsilon ( \Delta ^2 u , v)_{\Omega }  & =\varepsilon  (\nabla \Delta u, \nabla v )_{\Omega } - \varepsilon ( \partial _{n}\Delta u, v  )_{\Gamma } = \varepsilon (\nabla \Delta u, \nabla v )_{\Omega } - \varepsilon (g_{2} - \frac{1}{\varepsilon } f' ( u) g_{1} , v  )_{\Gamma }
    \end{split}
\]

Hence, we have a scheme for nonlinear spatial discretization. Let $u \in \left[ 0,T \right] \times V_{h}  $ and $v \in V_{h}$. We define the following CIP discretization
\begin{equation}
    \label{eq:cip_ch}
    \begin{split}
        a_{h} \left( u, v \right)   =& ( \Delta  u, \Delta v ) _{ \Omega } \\
                                     & + \left( \mean{  \Delta  u }, \jump{ \partial _{n }v} \right)_{\mathcal{F}_{h}  }  + \left( \mean{ \Delta  v }, \jump{ \partial _{n}u }      \right)_{\mathcal{F}_{h}  }  + \frac{\gamma }{h}  \left( \jump{ \partial _{n} u}, \jump{ \partial _{n} v   }   \right)_{\mathcal{F}_{h} } \\
                                     & + \left(   \Delta  u ,  \partial _{n }v \right)_{\Gamma   }  + \left(  \Delta  v ,  \partial _{n}u       \right)_{\Gamma  }  + \frac{\gamma }{h}  \left(  \partial _{n} u,  \partial _{n} v      \right)_{ \Gamma } \\
    c^{}_{h} ( u,v)  & = -( f( u), \Delta v )_{\mathcal{T} _{h}}+  ( f( u) , \jump{ \partial _{n}v }  )_{\mathcal{F} _{h}^{int}} + ( f(u), \partial _{n} v)_{\Gamma  }  + ( f'( u)  \partial _{n}u   ,  v)_{\Gamma } \\
    l_{h}( v_{}) & =  \left( h, v \right) _{\Omega } \red{- \varepsilon ( g_{2},  v )_{\Gamma } +\frac{1}{\varepsilon } (f(u),  v )_{\Gamma }} -  ( g_{1}, \Delta  v  )_{\Gamma }  + \frac{\gamma }{h} ( g_{1}, \partial _{n} v  )_{\Gamma }
    \end{split}
\end{equation}
s.t. that the following equation holds.
\[
    ( \partial _{t}u, v)_\Omega + \varepsilon  a_{h}( u,v) + \frac{1}{\varepsilon }c_{h}( u,v) - l_{h}(v)  = 0
\]


\subsection{Implicit Explicit Scheme}%
\label{sub:implicit_explicit_scheme}


For the Implicit explicit scheme (IMEX) sceheme we have the following discretization
\[
( \overline{\partial } _{t} U^{m}, v   )_{\Omega } + \varepsilon a^{m}_{h}( U^{M} , v) + \frac{1}{\varepsilon } ( P^{m} U^{m-1}, v) _{\Omega } =0, \quad \forall v \in V_{h}^{m}.
\]


\subsection{Introduction to numerical methods for Cahn Hilliard}%
\label{sub:introduction_to_numerical_methods_for_cahn_hilliard}

Present numerical results for CH in separate chapter including
\begin{itemize}
    \item Your numerical EOC for  manufactured solution for \textbf{linear} 4th order parabolic
    \item Your numerical EOC for  manufactured solution for \textbf{full} C-H
    \item Nice numerical example in 2d (flower)
    \item Nice numerical example in 3d (popcorn/doughnut geometries)
\end{itemize}


